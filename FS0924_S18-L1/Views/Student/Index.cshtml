@{
    ViewData["Title"] = "Students";
}

<h1>Students</h1>

<div id="root" class="container"></div>

<div class="modal" id="modalDetails" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 id="modalTitle" class="modal-title"></h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div id="modalBody" class="modal-body"></div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary">Save changes</button>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            let root = document.getElementById('root');

            fetch("Student/GetAllStudents", {
                method: 'GET'
            })
            .then(response => {
                if(response.ok) {
                    return response.text();
                }
            })
            .then(response => {
                root.innerHTML = response;

                new DataTable('#studentsTable');
            })
        })

        function showModalDetails(id) {
            fetch(`Student/Detail/${id}`, {
                method: 'GET'
            })
            .then(response => response.json())
            .then(response => {
                console.log(response)

                let detailsModal = new bootstrap.Modal(document.getElementById('modalDetails'));

                let title = document.getElementById('modalTitle');

                let body = document.getElementById('modalBody');


                title.textContent = `${response.name} ${response.surname}`;

                body.textContent = response.email;

                detailsModal.show();
            });
        }


    </script>
}